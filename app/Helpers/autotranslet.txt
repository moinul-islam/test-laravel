<?php

namespace App\Helpers;

use Stichoza\GoogleTranslate\GoogleTranslate;
use Illuminate\Support\Facades\Cache;
use Illuminate\Support\Facades\Session;

class AutoTranslate
{
    public static function text($text)
    {
        $locale = Session::get('locale', 'en');
        
        if ($locale == 'en' || empty($text)) {
            return $text;
        }
        
        $cacheKey = 'trans_' . md5($text) . '_' . $locale;
        
        return Cache::remember($cacheKey, 60 * 24 * 30, function () use ($text, $locale) {
            try {
                $tr = new GoogleTranslate();
                $tr->setSource('en');
                $tr->setTarget($locale);
                return $tr->translate($text);
            } catch (\Exception $e) {
                return $text;
            }
        });
    }
}